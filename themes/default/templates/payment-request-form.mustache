<!DOCTYPE html>
<html>

  <head>
    <title>Send Payment Request - Payment Driver</title>
    {{> head }}
  </head>

  <body>

    <div class="container">
      {{> logo }}
      {{> navbar }}

      <form method="post" action="{{#full_app_url}}/payment-requests{{/full_app_url}}" data-toggle="validator">
        <fieldset>
          <legend>New payment request</legend>

          <div class="row">
            <div class="col-sm-4">

              <label for="firstname" class="cols-sm-2 control-label">Customer first name</label>
              <div class="input-group mb-3">
                <input type="text" class="form-control" name="firstname" id="firstname" placeholder="first name" required />
              </div>

              <label for="lastname" class="cols-sm-2 control-label">Customer last name</label>
              <div class="input-group mb-3">
                <input type="text" class="form-control" name="lastname" id="lastname" placeholder="last name" required />
              </div>

              <label for="email" class="cols-sm-2 control-label">Customer email</label>
              <div class="input-group mb-3">
                <input type="email" class="form-control" name="email" id="email" placeholder="customer@example.com" required />
              </div>

              <label for="requestor" class="cols-sm-2 control-label">Requestor (your) email</label>
              <div class="input-group mb-3">
                <input type="email" class="form-control" name="requestor" id="requestor" placeholder="you@example.com" required />
              </div>

            </div>
            <div class="col-sm-4">

              <div class="form-group">
                <label for="account" class="cols-sm-2 control-label">Account to allocate payment</label>
                <div class="input-group mb-3">
                  <select class="selectpicker form-control" name="account" id="account" required>
                  <option value="">pick an account...</option>
                  <option value="hakkasanlv">Hakkasan, Las Vegas</option>
                  <option value="omnialv">OMNIA, Las Vegas</option>
                  <option value="omniasd">OMNIA, San Diego</option>
                  <option value="jewellv">Jewel Nightclub</option>
                  <option value="1oaklv">1OAK, Las Vegas</option>
                  <option value="wetrepublic">Wet Republic</option>
                  <option value="liquidlv">Liquid Pool, Las Vegas</option>
                </select>
                </div>
              </div>

              <div class="form-group has-feedback">
                <label for="amount" class="cols-sm-2 control-label">Payment amount</label>
                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text">$</span>
                  </div>
                  <input type="text" class="form-control" name="amount" id="amount" placeholder="00.00" pattern="[0-9]+\.[0-9]{0,2}$" required />
                </div>
              </div>

              <label for="expiration" class="cols-sm-2 control-label">Expiration</label>
              <div class="input-group mb-3">
                <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                  <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1"/>
                    <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                      <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
                </div>
              </div>

              <label for="description" class="cols-sm-2 control-label">Description</label>
              <div class="input-group mb-3">
                <textarea class="form-control" name="description" id="description" placeholder="What is this payment for?"></textarea>
              </div>

            </div>
            <div class="col-sm-4">

              <div class="form-group">
                <label for="additional-fields" class="cols-sm-2 control-label">Include additional fields</label>
                <div class="input-group mb-3">
                  <select class="selectpicker form-control" name="additional_fields" id="additional_fields">
                    <option value="none">None</option>
                    {{#fields}}
                        <option value="{{value}}">{{label}}</option>
                    {{/fields}}
                </select>
                </div>
              </div>

              <div class="" id="additional-fields-output"></div>

            </div>
          </div>

          <a class="btn btn-secondary" href="{{#full_app_url}}/payment-requests{{/full_app_url}}" role="button">cancel</a>
          <button class="btn btn-large btn-primary" type="submit">send payment request</button>
        </fieldset>
      </form>

      <div id="additional-fields-container" style="display:none" class="">
        {{#fields}}
          <div id="{{value}}" class="form-group">
            {{{ partial }}}
          </div>
        {{/fields}}
      </div>

      {{> footer }}
    </div>

    {{> scripts }}
    <script type="text/javascript">
      (function($){
        $("#additional_fields").on("change",function(){
          var output = $("#additional-fields-output");
          if($(this).val() === ""){
            output.empty();
          }else{
            var toInsert = $("#"+$(this).val()).clone();
            // toInsert.find('[readonly]').each(function(){
            //   $(this).removeAttr('readonly');
            // });
            output.html(toInsert);
          }
        })
      })(jQuery)

      jQuery(function () {
        $('#datetimepicker1').datetimepicker();
      });
    </script>
  </body>

</html>
